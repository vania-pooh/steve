<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
       http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd">

    <import resource="provider-config.xml"/>

    <bean id="jobAware" class="ru.meridor.steve.LocalJobAware">
        <constructor-arg ref="provider"/>
    </bean>

    <bean id="launchStrategy" class="ru.meridor.steve.LaunchStrategyFactory" factory-method="createStrategy"/>

    <bean class="ru.meridor.steve.impl.LauncherImpl">
        <constructor-arg index="0" ref="launchStrategy"/>
        <constructor-arg index="1" ref="jobAware"/>
    </bean>

    <camelContext xmlns="http://camel.apache.org/schema/spring" allowUseOriginalMessage="false" streamCache="true">
        <proxy id="launchStrategy"
               serviceInterface="ru.meridor.steve.LaunchStrategy"
               serviceUrl="seda:jobs"/>

        <route>
            <from uri="seda:jobs"/>
            <to uri="bean:executor"/>
        </route>

    </camelContext>

</beans>